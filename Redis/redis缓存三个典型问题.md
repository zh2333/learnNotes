### 缓存穿透

缓存穿透指的是用户请求去查询一条数据库和缓存中没有的数据, 缓存中没有, 就会去数据库中查. 如果有人利用此恶意请求, 这个请求就会一直查询数据库集, 数据库的访问压力就会增大.

解决:

1. 缓存空对象

   用户第一次请求经过缓存, 查询不存在, 访问数据库, 数据库返回为空, 此时将空对象存入缓存. 用户再次访问时就会命中缓存, 不在访问数据库. 这个方法存在什么问题呢? 如果用户恶意访问, 必然会造成缓存中存储了很多空对象, 占用内存空间. 浪费资源. 针对这种情况, 在设置空对象的时候, 给一个较短的过期时间. 这种方法不好

2. 布隆过滤器

   业务中, 一般采用定时任务, 初始化布隆过滤器, 将所有可能存在的数据hash到一个bitmap中, 一个不存在的数据, 首先会被布隆过滤器拦截.





### 缓存击穿

缓存击穿是指, 高并发对一个热点key访问, 当这个热点key失效的瞬间, 持续高并发就会穿破缓存, 直接请求数据库, 瞬间增加数据库的访问压力.

解决:

加锁. 加锁后, 并发访问时, 只有第一个进来的请求执行, 将数据存入缓存, 接下来的访问就会直接命中缓存. 业务中, 根据key获取value的值为空时, 给该key加上锁, 从数据库中加载数据后再释放锁. 其他线程获取锁失败, 说明某个线程正在从数据库中加载数据, 这个时候sleep下重试.

> 单机环境使用普通锁, 分布式环境使用分布式锁





### 缓存雪崩

缓存雪崩是指某个时间段, 缓存几种过期失效, 无数请求到达数据库, 给数据库造成压力

造成缓存雪崩的原因:

1. redis宕机
2. 大部分数据失效

解决方法:

1. 搭建高可用的集群, 防止单机的redis过期
2. 设置不同的过期时间, 防止同一时间内大量的key失效

